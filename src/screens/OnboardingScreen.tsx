import React, { useState, useRef } from 'react';
import {
  View,
  Text,
  StyleSheet,
  TouchableOpacity,
  ScrollView,
  Dimensions,
  Platform,
} from 'react-native';
import { SafeAreaView, useSafeAreaInsets } from 'react-native-safe-area-context';
import { Ionicons } from '@expo/vector-icons';
import Svg, { Path } from 'react-native-svg';
import AsyncStorage from '@react-native-async-storage/async-storage';
import { useT } from '../i18n/i18n';
import { useTheme } from '../theme/Theme';
import { triggerImpact, triggerSelection } from '../utils/Haptics';

interface OnboardingScreenProps {
  navigation?: any;
  onComplete: () => void;
}

const { width: SCREEN_WIDTH } = Dimensions.get('window');

export default function OnboardingScreen({ navigation, onComplete }: OnboardingScreenProps) {
  const t = useT();
  const { colors, mode } = useTheme();
  const insets = useSafeAreaInsets();
  const scrollViewRef = useRef<ScrollView>(null);
  const [currentPage, setCurrentPage] = useState(0);
  const [selectedMode, setSelectedMode] = useState<'strict' | 'detailed' | null>('detailed');

  // Charger le mode sélectionné si déjà défini
  React.useEffect(() => {
    const loadSelectedMode = async () => {
      try {
        const detailedEnabled = await AsyncStorage.getItem('detailed_consumption_enabled');
        if (detailedEnabled === 'true') {
          setSelectedMode('detailed');
        } else if (detailedEnabled === 'false') {
          setSelectedMode('strict');
        }
      } catch (error) {
        console.error('Erreur lors du chargement du mode:', error);
      }
    };
    loadSelectedMode();
  }, []);

  const onboardingPages = [
    {
      icon: 'app-icon', // Marqueur spécial pour utiliser l'icône de l'app
      title: t('onboarding.page1.title' as any),
      description: t('onboarding.page1.description' as any),
      color: '#4CAF50',
    },
    {
      icon: 'home-outline',
      title: t('onboarding.page2.title' as any),
      description: t('onboarding.page2.description' as any),
      color: '#4CAF50',
    },
    {
      icon: 'calendar-outline',
      title: t('onboarding.page3.title' as any),
      description: t('onboarding.page3.description' as any),
      color: '#2196F3',
    },
    {
      icon: 'options-outline',
      title: t('onboarding.page4.title' as any),
      description: t('onboarding.page4.description' as any),
      color: '#FF9800',
    },
    {
      icon: 'stats-chart-outline',
      title: t('onboarding.page5.title' as any),
      description: t('onboarding.page5.description' as any),
      color: '#9C27B0',
    },
    {
      icon: 'trophy-outline',
      title: t('onboarding.page6.title' as any),
      description: t('onboarding.page6.description' as any),
      color: '#E91E63',
    },
  ];

  const handleNext = () => {
    // Sur la page 4, vérifier qu'un mode est sélectionné
    if (currentPage === 3 && !selectedMode) {
      triggerImpact();
      return; // Ne pas avancer si aucun mode n'est sélectionné
    }
    
    triggerSelection();
    if (currentPage < onboardingPages.length - 1) {
      const nextPage = currentPage + 1;
      setCurrentPage(nextPage);
      scrollViewRef.current?.scrollTo({ x: nextPage * SCREEN_WIDTH, animated: true });
    } else {
      handleComplete();
    }
  };

  const handleSkip = () => {
    triggerImpact();
    handleComplete();
  };

  const handleComplete = async () => {
    // Sauvegarder le choix du mode si sélectionné
    if (selectedMode) {
      try {
        await AsyncStorage.setItem('detailed_consumption_enabled', selectedMode === 'detailed' ? 'true' : 'false');
      } catch (error) {
        console.error('Erreur lors de la sauvegarde du mode:', error);
      }
    }
    onComplete();
  };

  const handleModeSelect = (mode: 'strict' | 'detailed') => {
    triggerSelection();
    setSelectedMode(mode);
  };

  const handlePageChange = (event: any) => {
    const page = Math.round(event.nativeEvent.contentOffset.x / SCREEN_WIDTH);
    setCurrentPage(page);
  };

  return (
    <SafeAreaView style={[styles.container, { backgroundColor: colors.background }]} edges={['top', 'bottom']}>
      {/* Header avec bouton Skip */}
      <View style={styles.header}>
        <TouchableOpacity 
          onPress={handleSkip} 
          style={[
            styles.skipButton,
            mode === 'dark' && {
              backgroundColor: colors.card,
              paddingHorizontal: 16,
              paddingVertical: 8,
              borderRadius: 8,
            }
          ]}
        >
          <Text style={[styles.skipText, { color: mode === 'dark' ? colors.text : colors.mutedText }]}>
            {t('onboarding.skip' as any)}
          </Text>
        </TouchableOpacity>
      </View>

      {/* Pages d'onboarding */}
      <ScrollView
        ref={scrollViewRef}
        horizontal
        pagingEnabled={false}
        showsHorizontalScrollIndicator={false}
        onMomentumScrollEnd={handlePageChange}
        scrollEventThrottle={16}
        scrollEnabled={false}
        bounces={false}
      >
        {onboardingPages.map((page, index) => (
          <View key={index} style={[styles.page, { width: SCREEN_WIDTH }]}>
            {index === 3 ? (
              // Page 4 avec ScrollView vertical pour permettre le défilement
              <ScrollView
                style={styles.scrollableContent}
                contentContainerStyle={styles.scrollableContentContainer}
                showsVerticalScrollIndicator={true}
                bounces={true}
              >
                <View style={styles.content}>
                  {page.icon === 'app-icon' ? (
                    <Svg width={100} height={100} viewBox="0 0 1024 1024" style={styles.appIcon}>
                      <Path
                        d="M 513.231 271.750 C 512.183 273.262, 511.006 275.175, 510.615 276 C 510.224 276.825, 508.914 279.144, 507.702 281.153 C 499.684 294.454, 495.447 301.633, 495.105 302.500 C 494.887 303.050, 493.425 305.140, 491.855 307.144 C 490.285 309.148, 489 311.080, 489 311.436 C 489 312.040, 488.104 313.254, 485.408 316.305 C 484.807 316.985, 483.838 318.432, 483.253 319.521 C 482.669 320.609, 477.873 327.283, 472.596 334.351 C 467.318 341.419, 463 347.606, 463 348.101 C 463 348.595, 462.325 349, 461.500 349 C 460.675 349, 460 349.649, 460 350.443 C 460 351.237, 459.171 352.475, 458.159 353.193 C 457.146 353.912, 455.762 355.547, 455.083 356.826 C 454.404 358.105, 453.095 359.930, 452.174 360.881 C 451.253 361.833, 448.925 364.547, 447 366.912 C 437.966 378.014, 435.732 380.680, 433.452 383.083 C 432.103 384.504, 431 385.978, 431 386.360 C 431 386.741, 428.552 389.628, 425.560 392.776 C 422.569 395.924, 417.956 401.201, 415.310 404.502 C 412.665 407.803, 409.600 411.409, 408.500 412.514 C 407.400 413.619, 404.700 416.750, 402.500 419.471 C 400.300 422.192, 397.825 425.171, 397 426.090 C 396.175 427.010, 394.600 428.972, 393.500 430.451 C 392.400 431.930, 390.375 434.421, 389 435.987 C 387.625 437.553, 385.825 439.858, 385 441.109 C 384.175 442.360, 382.600 444.363, 381.500 445.559 C 380.400 446.755, 379.050 448.402, 378.500 449.220 C 377.950 450.038, 375.925 452.731, 374 455.205 C 365.580 466.026, 359 475.039, 359 475.750 C 359 476.173, 358.100 477.081, 357 477.768 C 355.900 478.455, 355 479.656, 355 480.437 C 355 481.218, 354.418 482.452, 353.707 483.179 C 352.267 484.651, 345.188 496.954, 343.286 501.290 C 342.614 502.824, 341.374 504.769, 340.531 505.611 C 339.689 506.454, 339 507.700, 339 508.381 C 339 509.063, 337.425 512.817, 335.500 516.725 C 333.575 520.632, 332 524.374, 332 525.039 C 332 525.705, 330.935 528.781, 329.633 531.875 C 328.331 534.969, 326.739 539.525, 326.095 542 C 319.586 567.007, 318.584 574.855, 318.630 600.500 C 318.662 618.686, 319.057 624.726, 320.911 635.343 C 322.145 642.407, 323.850 650.057, 324.701 652.343 C 325.552 654.629, 326.615 658.300, 327.064 660.500 C 328.853 669.258, 340.280 696, 342.234 696 C 342.656 696, 343 696.763, 343 697.696 C 343 699.383, 347.818 707.197, 349.250 707.833 C 349.663 708.017, 350 708.770, 350 709.507 C 350 710.244, 351.125 712.184, 352.500 713.818 C 353.875 715.452, 355 717.270, 355 717.859 C 355 718.448, 355.900 719.411, 357 720 C 358.100 720.589, 359 721.505, 359 722.035 C 359 722.566, 359.788 723.823, 360.750 724.829 C 361.712 725.836, 364.964 729.548, 367.975 733.079 C 374.121 740.287, 391.168 756, 392.841 756 C 393.440 756, 394.411 756.900, 395 758 C 395.589 759.100, 396.617 760.001, 397.285 760.002 C 397.953 760.004, 400.045 761.326, 401.934 762.940 C 403.823 764.554, 407.311 766.874, 409.684 768.095 C 412.058 769.316, 414 770.694, 414 771.157 C 414 771.621, 414.845 772, 415.878 772 C 416.910 772, 418.297 772.653, 418.960 773.451 C 420.464 775.264, 438.171 784, 440.341 784 C 441.220 784, 443.415 784.808, 445.220 785.796 C 447.024 786.784, 450.525 788.178, 453 788.894 C 455.475 789.609, 458.281 790.601, 459.236 791.097 C 460.191 791.594, 461.766 792.007, 462.736 792.015 C 463.706 792.023, 466.525 792.758, 469 793.649 C 471.475 794.540, 477.100 795.626, 481.500 796.063 C 485.900 796.500, 492.425 797.340, 496 797.930 C 504.295 799.301, 529.529 799.296, 538 797.923 C 541.575 797.343, 547.875 796.504, 552 796.059 C 556.125 795.613, 561.525 794.582, 564 793.768 C 566.475 792.954, 570.525 791.718, 573 791.021 C 583.070 788.187, 586.794 786.869, 588.601 785.501 C 589.646 784.710, 591.677 784.049, 593.115 784.032 C 594.553 784.014, 596.803 783.180, 598.115 782.178 C 599.427 781.177, 603.095 779.321, 606.267 778.055 C 609.439 776.790, 612.282 775.353, 612.585 774.863 C 612.888 774.372, 614.989 773.026, 617.255 771.870 C 619.521 770.714, 621.997 769.145, 622.759 768.384 C 623.520 767.623, 624.479 767, 624.891 767 C 625.861 767, 638.307 757.851, 644.890 752.299 C 646.326 751.089, 649.750 748.215, 652.500 745.913 C 655.250 743.611, 657.816 741.192, 658.202 740.538 C 658.894 739.366, 667.367 729.803, 671.750 725.248 C 672.987 723.961, 674 722.691, 674 722.425 C 674 722.159, 675.800 719.664, 678 716.881 C 680.200 714.098, 682 711.208, 682 710.460 C 682 709.712, 682.627 708.740, 683.392 708.300 C 684.158 707.860, 685.533 705.925, 686.448 704 C 689.430 697.723, 690.462 696, 691.237 696 C 691.657 696, 692 695.339, 692 694.530 C 692 693.034, 695.450 686.275, 697.094 684.550 C 697.592 684.027, 698 682.651, 698 681.491 C 698 680.331, 698.650 678.509, 699.445 677.441 C 700.240 676.374, 702.087 671.675, 703.551 667 C 706.186 658.587, 706.688 657.145, 708.875 651.703 C 709.494 650.165, 710 647.315, 710 645.370 C 710 643.425, 710.976 638.158, 712.168 633.667 C 714.120 626.311, 714.336 622.969, 714.341 600 C 714.346 578.776, 714.056 573.494, 712.614 568.500 C 711.661 565.200, 710.520 559.547, 710.077 555.939 C 709.635 552.330, 708.595 547.830, 707.766 545.939 C 706.937 544.047, 705.700 540.475, 705.016 538 C 703.480 532.442, 702.362 529.554, 699.909 524.802 C 698.859 522.768, 698 520.270, 698 519.252 C 698 518.233, 697.580 516.972, 697.067 516.450 C 696.554 515.928, 694.754 512.867, 693.067 509.648 C 690.066 503.922, 689.161 500, 690.843 500 C 691.306 500, 692.533 498.425, 693.570 496.500 C 694.607 494.575, 695.814 493, 696.252 493 C 696.691 493, 697.477 491.875, 698 490.500 C 698.523 489.125, 699.348 488, 699.834 488 C 700.319 488, 702.360 485.525, 704.369 482.500 C 706.377 479.475, 708.466 477, 709.010 477 C 709.555 477, 710 476.347, 710 475.550 C 710 474.752, 710.611 473.740, 711.357 473.300 C 712.805 472.446, 722 461.387, 722 460.499 C 722 459.885, 732.897 445.592, 735.941 442.215 C 737.073 440.958, 738 439.499, 738 438.973 C 738 438.447, 738.900 437.455, 740 436.768 C 741.100 436.081, 742 435.202, 742 434.815 C 742 434.428, 743.596 432.399, 745.547 430.306 C 747.498 428.213, 749.845 425.262, 750.762 423.750 C 751.680 422.238, 752.784 421, 753.216 421 C 753.647 421, 754 420.555, 754 420.011 C 754 419.133, 755.340 417.236, 758.500 413.638 C 763.537 407.905, 768 400.883, 768 398.693 C 768 395.695, 764.961 393.560, 762.022 394.493 C 760.976 394.825, 757.956 397.644, 755.310 400.757 C 752.665 403.871, 749.487 407.388, 748.250 408.574 C 747.013 409.759, 746 411.010, 746 411.353 C 746 412.197, 743.005 415.827, 740.250 418.323 C 739.013 419.444, 738 420.790, 738 421.316 C 738 421.841, 736.987 423.324, 735.750 424.611 C 734.513 425.898, 732.825 427.772, 732 428.775 C 731.175 429.778, 727.575 434.170, 724 438.535 C 715.352 449.095, 714.861 449.673, 712.250 452.389 C 711.013 453.676, 710 455.215, 710 455.808 C 710 456.401, 709.212 457.476, 708.250 458.197 C 707.288 458.917, 704.942 461.530, 703.037 464.003 C 701.132 466.476, 699.220 468.650, 698.787 468.833 C 698.354 469.017, 698 469.788, 698 470.548 C 698 471.308, 697.100 472.411, 696 473 C 694.900 473.589, 694 474.448, 694 474.909 C 694 475.370, 692.200 477.716, 690 480.123 C 687.800 482.530, 686 485.046, 686 485.714 C 686 486.383, 685.100 487.411, 684 488 C 682.900 488.589, 681.998 489.617, 681.995 490.285 C 681.993 490.953, 680.755 492.850, 679.245 494.500 C 677.735 496.150, 674.925 499.669, 673 502.319 C 669.881 506.613, 665.647 511.926, 659.899 518.758 C 658.855 519.999, 657.998 521.349, 657.995 521.758 C 657.993 522.166, 656.643 523.938, 654.995 525.696 C 653.348 527.453, 652 529.282, 652 529.759 C 652 530.236, 650.650 531.919, 649 533.500 C 647.350 535.081, 646 536.949, 646 537.652 C 646 538.355, 645.100 539.411, 644 540 C 642.900 540.589, 642 541.730, 642 542.535 C 642 543.341, 641.656 544, 641.236 544 C 640.816 544, 639.360 545.800, 638 548 C 636.640 550.200, 635.184 552, 634.764 552 C 634.344 552, 634 552.659, 634 553.465 C 634 554.270, 633.100 555.411, 632 556 C 630.900 556.589, 629.999 557.617, 629.999 558.285 C 629.998 558.953, 628.198 561.525, 626 564 C 623.802 566.475, 622.002 568.912, 622.001 569.416 C 622.001 569.920, 621.344 571.045, 620.542 571.916 C 616.204 576.629, 606 589.620, 606 590.430 C 606 591.011, 603.924 593.666, 600.282 597.741 C 599.062 599.106, 597.794 601.073, 597.465 602.111 C 597.135 603.150, 596.221 604, 595.433 604 C 594.645 604, 594 604.679, 594 605.509 C 594 606.339, 592.650 608.431, 591 610.157 C 589.350 611.884, 588 613.704, 588 614.203 C 588 614.701, 586.652 616.547, 585.005 618.304 C 583.357 620.062, 582.007 621.834, 582.005 622.241 C 582.002 622.649, 580.650 624.273, 579 625.850 C 577.350 627.426, 575.998 629.118, 575.995 629.608 C 575.993 630.099, 574.755 631.871, 573.245 633.547 C 571.735 635.223, 570.050 637.315, 569.500 638.195 C 566.156 643.548, 561.468 649.684, 559.865 650.807 C 558.839 651.525, 558 652.988, 558 654.057 C 558 655.135, 557.318 656, 556.469 656 C 555.626 656, 554.645 656.788, 554.287 657.750 C 553.929 658.712, 551.918 661.843, 549.818 664.707 C 547.718 667.571, 546 670.353, 546 670.890 C 546 671.426, 545.100 672.151, 544 672.500 C 542.900 672.849, 542 673.739, 542 674.478 C 542 675.216, 540.200 678.098, 538 680.881 C 535.800 683.664, 534 686.404, 534 686.971 C 534 687.537, 533.626 688, 533.169 688 C 532.712 688, 531.702 689.237, 530.926 690.750 C 530.149 692.263, 528.723 694.228, 527.757 695.117 C 526.791 696.007, 526 697.212, 526 697.796 C 526 699.240, 517.518 708, 516.120 708 C 515.504 708, 515 708.378, 515 708.839 C 515 710.249, 510.120 712, 506.203 711.996 C 500.371 711.990, 494.489 707.886, 489.013 700 C 487.676 698.075, 485.776 695.912, 484.791 695.193 C 483.806 694.475, 483 693.483, 483 692.989 C 483 692.495, 481.988 691.014, 480.750 689.698 C 479.512 688.382, 476.925 685.340, 475 682.938 C 473.075 680.536, 469.869 676.755, 467.877 674.536 C 462.184 668.195, 454 657.757, 454 656.836 C 454 656.376, 453.325 656, 452.500 656 C 451.675 656, 451 655.580, 451 655.067 C 451 654.554, 447.574 650.167, 443.387 645.317 C 434.382 634.888, 431.525 631.490, 427.500 626.421 C 425.850 624.343, 423.601 621.712, 422.503 620.574 C 421.405 619.437, 418.978 616.480, 417.110 614.003 C 415.242 611.526, 413.089 608.825, 412.326 608 C 408.449 603.807, 407 601.490, 407 599.482 C 407 596.856, 410.573 592, 412.505 592 C 413.253 592, 414.151 591.100, 414.500 590 C 414.849 588.900, 415.764 588, 416.532 588 C 417.301 588, 418.411 587.100, 419 586 C 419.589 584.900, 420.730 584, 421.535 584 C 422.341 584, 423.003 583.663, 423.007 583.250 C 423.011 582.837, 425.771 580.250, 429.140 577.500 C 432.509 574.750, 435.768 572.050, 436.382 571.500 C 439.443 568.761, 444.993 565, 445.974 565 C 447.268 565, 453.331 569.108, 453.866 570.347 C 454.067 570.813, 455.529 572.672, 457.116 574.479 C 458.702 576.286, 460 578.267, 460 578.882 C 460 579.497, 460.675 580, 461.500 580 C 462.325 580, 463 580.381, 463 580.847 C 463 581.652, 464.140 583.156, 469.258 589.107 C 470.491 590.540, 473.075 593.655, 475 596.028 C 476.925 598.401, 479.512 601.411, 480.750 602.717 C 481.988 604.023, 483.009 605.408, 483.020 605.795 C 483.030 606.183, 485.168 608.766, 487.770 611.536 C 490.371 614.306, 494.446 619.117, 496.825 622.227 C 503.221 630.586, 503.161 630.563, 507.314 626.250 C 523.423 609.516, 531.142 601.389, 535 597.095 C 537.475 594.341, 540.063 592.068, 540.750 592.044 C 541.438 592.020, 542 591.531, 542 590.957 C 542 590.383, 544.700 587.288, 548 584.079 C 551.300 580.870, 554 577.739, 554 577.122 C 554 576.505, 554.460 576, 555.022 576 C 556.148 576, 566 565.992, 566 564.849 C 566 564.456, 566.900 563.849, 568 563.500 C 569.100 563.151, 570 562.415, 570 561.866 C 570 561.316, 575.400 555.508, 582 548.959 C 588.600 542.410, 594 536.859, 594 536.622 C 594 536.385, 600.300 529.757, 608 521.894 C 615.700 514.030, 622 507.012, 622 506.298 C 622 505.584, 622.510 505, 623.134 505 C 624.555 505, 634 495.488, 634 494.056 C 634 493.475, 634.464 493, 635.031 493 C 635.859 493, 646 483.316, 646 482.526 C 646 482.406, 650.040 478.076, 654.977 472.904 C 659.914 467.732, 663.964 463.210, 663.977 462.856 C 663.990 462.501, 662.650 460.766, 661 459 C 659.350 457.234, 658 455.161, 658 454.394 C 658 453.627, 657.605 453, 657.122 453 C 656.638 453, 654.276 450.413, 651.872 447.250 C 649.467 444.087, 647.163 441.350, 646.750 441.167 C 646.337 440.983, 646 440.221, 646 439.473 C 646 438.725, 645.212 437.525, 644.249 436.807 C 643.287 436.088, 641.268 433.851, 639.765 431.837 C 638.261 429.822, 636.448 427.572, 635.737 426.837 C 635.026 426.101, 632.269 422.800, 629.610 419.500 C 626.951 416.200, 624.151 413.140, 623.387 412.700 C 622.624 412.260, 621.997 411.360, 621.994 410.700 C 621.990 410.040, 619.852 407.182, 617.241 404.349 C 610.567 397.107, 606 391.301, 606 390.059 C 606 389.476, 605.311 389, 604.469 389 C 603.626 389, 602.642 388.212, 602.281 387.250 C 601.919 386.288, 601.087 385.050, 600.431 384.500 C 598.318 382.730, 588 370.087, 588 369.269 C 588 368.834, 586.650 367.363, 585 366 C 583.350 364.637, 582 363.153, 582 362.702 C 582 361.973, 576.388 354.275, 574.927 353 C 574.612 352.725, 574.064 351.712, 573.708 350.750 C 573.353 349.788, 572.374 349, 571.531 349 C 570.689 349, 570 348.345, 570 347.545 C 570 346.745, 568.987 344.991, 567.750 343.646 C 564.103 339.683, 558 331.266, 558 330.200 C 558 329.658, 557.349 328.964, 556.552 328.658 C 555.756 328.353, 554.357 326.657, 553.443 324.890 C 552.529 323.123, 550.706 320.517, 549.391 319.099 C 548.076 317.681, 547 316.032, 547 315.435 C 547 314.837, 545.875 313.292, 544.500 312 C 543.125 310.708, 542 309.042, 542 308.296 C 542 307.551, 540.200 304.664, 538 301.881 C 535.800 299.098, 534 296.241, 534 295.533 C 534 294.824, 533.299 293.663, 532.442 292.952 C 531.585 292.241, 530.258 290.161, 529.493 288.330 C 528.728 286.498, 527.629 285, 527.051 285 C 526.473 285, 526 284.100, 526 283 C 526 281.900, 525.663 280.996, 525.250 280.992 C 524.497 280.984, 522 276.261, 522 274.846 C 522 273.791, 517.101 269, 516.023 269 C 515.535 269, 514.279 270.238, 513.231 271.750"
                        fill="#1fbf56"
                        fillRule="evenodd"
                      />
                    </Svg>
                  ) : (
                    <View style={[styles.iconContainer, { backgroundColor: `${page.color}20` }]}>
                      <Ionicons name={page.icon as any} size={60} color={page.color} />
                    </View>
                  )}
                  <Text style={[styles.title, { color: colors.text }]}>{page.title}</Text>
                  <View style={styles.modesContainer}>
                  <TouchableOpacity
                    onPress={() => handleModeSelect('strict')}
                    style={[
                      styles.modeCard,
                      {
                        backgroundColor: selectedMode === 'strict' 
                          ? (mode === 'dark' ? colors.primary + '20' : '#f1f8e9')
                          : colors.card,
                        borderWidth: selectedMode === 'strict' ? 2 : 1,
                        borderColor: selectedMode === 'strict' ? colors.primary : (mode === 'dark' ? colors.border : colors.mutedText + '15'),
                      },
                    ]}
                    activeOpacity={0.7}
                  >
                    {selectedMode === 'strict' && (
                      <View style={styles.checkIconContainer}>
                        <Ionicons name="checkmark-circle" size={24} color={colors.primary} />
                      </View>
                    )}
                    <Text style={[styles.modeTitle, { color: colors.text }]}>
                      {t('onboarding.page4.mode1.title' as any)}
                    </Text>
                    <Text style={[styles.modeDescription, { color: colors.mutedText }]}>
                      {t('onboarding.page4.mode1.description' as any)}
                    </Text>
                  </TouchableOpacity>
                  <View style={styles.modeSpacer} />
                  <TouchableOpacity
                    onPress={() => handleModeSelect('detailed')}
                    style={[
                      styles.modeCard,
                      {
                        backgroundColor: selectedMode === 'detailed' 
                          ? (mode === 'dark' ? colors.primary + '20' : '#f1f8e9')
                          : colors.card,
                        borderWidth: selectedMode === 'detailed' ? 2 : 1,
                        borderColor: selectedMode === 'detailed' ? colors.primary : (mode === 'dark' ? colors.border : colors.mutedText + '15'),
                      },
                    ]}
                    activeOpacity={0.7}
                  >
                    {selectedMode === 'detailed' && (
                      <View style={styles.checkIconContainer}>
                        <Ionicons name="checkmark-circle" size={24} color={colors.primary} />
                      </View>
                    )}
                    <Text style={[styles.modeTitle, { color: colors.text }]}>
                      {t('onboarding.page4.mode2.title' as any)}
                    </Text>
                    <Text style={[styles.modeDescription, { color: colors.mutedText }]}>
                      {t('onboarding.page4.mode2.description' as any)}
                    </Text>
                  </TouchableOpacity>
                </View>
                </View>
              </ScrollView>
            ) : (
              <View style={styles.content}>
                {page.icon === 'app-icon' ? (
                  <Svg width={100} height={100} viewBox="0 0 1024 1024" style={styles.appIcon}>
                    <Path
                      d="M 513.231 271.750 C 512.183 273.262, 511.006 275.175, 510.615 276 C 510.224 276.825, 508.914 279.144, 507.702 281.153 C 499.684 294.454, 495.447 301.633, 495.105 302.500 C 494.887 303.050, 493.425 305.140, 491.855 307.144 C 490.285 309.148, 489 311.080, 489 311.436 C 489 312.040, 488.104 313.254, 485.408 316.305 C 484.807 316.985, 483.838 318.432, 483.253 319.521 C 482.669 320.609, 477.873 327.283, 472.596 334.351 C 467.318 341.419, 463 347.606, 463 348.101 C 463 348.595, 462.325 349, 461.500 349 C 460.675 349, 460 349.649, 460 350.443 C 460 351.237, 459.171 352.475, 458.159 353.193 C 457.146 353.912, 455.762 355.547, 455.083 356.826 C 454.404 358.105, 453.095 359.930, 452.174 360.881 C 451.253 361.833, 448.925 364.547, 447 366.912 C 437.966 378.014, 435.732 380.680, 433.452 383.083 C 432.103 384.504, 431 385.978, 431 386.360 C 431 386.741, 428.552 389.628, 425.560 392.776 C 422.569 395.924, 417.956 401.201, 415.310 404.502 C 412.665 407.803, 409.600 411.409, 408.500 412.514 C 407.400 413.619, 404.700 416.750, 402.500 419.471 C 400.300 422.192, 397.825 425.171, 397 426.090 C 396.175 427.010, 394.600 428.972, 393.500 430.451 C 392.400 431.930, 390.375 434.421, 389 435.987 C 387.625 437.553, 385.825 439.858, 385 441.109 C 384.175 442.360, 382.600 444.363, 381.500 445.559 C 380.400 446.755, 379.050 448.402, 378.500 449.220 C 377.950 450.038, 375.925 452.731, 374 455.205 C 365.580 466.026, 359 475.039, 359 475.750 C 359 476.173, 358.100 477.081, 357 477.768 C 355.900 478.455, 355 479.656, 355 480.437 C 355 481.218, 354.418 482.452, 353.707 483.179 C 352.267 484.651, 345.188 496.954, 343.286 501.290 C 342.614 502.824, 341.374 504.769, 340.531 505.611 C 339.689 506.454, 339 507.700, 339 508.381 C 339 509.063, 337.425 512.817, 335.500 516.725 C 333.575 520.632, 332 524.374, 332 525.039 C 332 525.705, 330.935 528.781, 329.633 531.875 C 328.331 534.969, 326.739 539.525, 326.095 542 C 319.586 567.007, 318.584 574.855, 318.630 600.500 C 318.662 618.686, 319.057 624.726, 320.911 635.343 C 322.145 642.407, 323.850 650.057, 324.701 652.343 C 325.552 654.629, 326.615 658.300, 327.064 660.500 C 328.853 669.258, 340.280 696, 342.234 696 C 342.656 696, 343 696.763, 343 697.696 C 343 699.383, 347.818 707.197, 349.250 707.833 C 349.663 708.017, 350 708.770, 350 709.507 C 350 710.244, 351.125 712.184, 352.500 713.818 C 353.875 715.452, 355 717.270, 355 717.859 C 355 718.448, 355.900 719.411, 357 720 C 358.100 720.589, 359 721.505, 359 722.035 C 359 722.566, 359.788 723.823, 360.750 724.829 C 361.712 725.836, 364.964 729.548, 367.975 733.079 C 374.121 740.287, 391.168 756, 392.841 756 C 393.440 756, 394.411 756.900, 395 758 C 395.589 759.100, 396.617 760.001, 397.285 760.002 C 397.953 760.004, 400.045 761.326, 401.934 762.940 C 403.823 764.554, 407.311 766.874, 409.684 768.095 C 412.058 769.316, 414 770.694, 414 771.157 C 414 771.621, 414.845 772, 415.878 772 C 416.910 772, 418.297 772.653, 418.960 773.451 C 420.464 775.264, 438.171 784, 440.341 784 C 441.220 784, 443.415 784.808, 445.220 785.796 C 447.024 786.784, 450.525 788.178, 453 788.894 C 455.475 789.609, 458.281 790.601, 459.236 791.097 C 460.191 791.594, 461.766 792.007, 462.736 792.015 C 463.706 792.023, 466.525 792.758, 469 793.649 C 471.475 794.540, 477.100 795.626, 481.500 796.063 C 485.900 796.500, 492.425 797.340, 496 797.930 C 504.295 799.301, 529.529 799.296, 538 797.923 C 541.575 797.343, 547.875 796.504, 552 796.059 C 556.125 795.613, 561.525 794.582, 564 793.768 C 566.475 792.954, 570.525 791.718, 573 791.021 C 583.070 788.187, 586.794 786.869, 588.601 785.501 C 589.646 784.710, 591.677 784.049, 593.115 784.032 C 594.553 784.014, 596.803 783.180, 598.115 782.178 C 599.427 781.177, 603.095 779.321, 606.267 778.055 C 609.439 776.790, 612.282 775.353, 612.585 774.863 C 612.888 774.372, 614.989 773.026, 617.255 771.870 C 619.521 770.714, 621.997 769.145, 622.759 768.384 C 623.520 767.623, 624.479 767, 624.891 767 C 625.861 767, 638.307 757.851, 644.890 752.299 C 646.326 751.089, 649.750 748.215, 652.500 745.913 C 655.250 743.611, 657.816 741.192, 658.202 740.538 C 658.894 739.366, 667.367 729.803, 671.750 725.248 C 672.987 723.961, 674 722.691, 674 722.425 C 674 722.159, 675.800 719.664, 678 716.881 C 680.200 714.098, 682 711.208, 682 710.460 C 682 709.712, 682.627 708.740, 683.392 708.300 C 684.158 707.860, 685.533 705.925, 686.448 704 C 689.430 697.723, 690.462 696, 691.237 696 C 691.657 696, 692 695.339, 692 694.530 C 692 693.034, 695.450 686.275, 697.094 684.550 C 697.592 684.027, 698 682.651, 698 681.491 C 698 680.331, 698.650 678.509, 699.445 677.441 C 700.240 676.374, 702.087 671.675, 703.551 667 C 706.186 658.587, 706.688 657.145, 708.875 651.703 C 709.494 650.165, 710 647.315, 710 645.370 C 710 643.425, 710.976 638.158, 712.168 633.667 C 714.120 626.311, 714.336 622.969, 714.341 600 C 714.346 578.776, 714.056 573.494, 712.614 568.500 C 711.661 565.200, 710.520 559.547, 710.077 555.939 C 709.635 552.330, 708.595 547.830, 707.766 545.939 C 706.937 544.047, 705.700 540.475, 705.016 538 C 703.480 532.442, 702.362 529.554, 699.909 524.802 C 698.859 522.768, 698 520.270, 698 519.252 C 698 518.233, 697.580 516.972, 697.067 516.450 C 696.554 515.928, 694.754 512.867, 693.067 509.648 C 690.066 503.922, 689.161 500, 690.843 500 C 691.306 500, 692.533 498.425, 693.570 496.500 C 694.607 494.575, 695.814 493, 696.252 493 C 696.691 493, 697.477 491.875, 698 490.500 C 698.523 489.125, 699.348 488, 699.834 488 C 700.319 488, 702.360 485.525, 704.369 482.500 C 706.377 479.475, 708.466 477, 709.010 477 C 709.555 477, 710 476.347, 710 475.550 C 710 474.752, 710.611 473.740, 711.357 473.300 C 712.805 472.446, 722 461.387, 722 460.499 C 722 459.885, 732.897 445.592, 735.941 442.215 C 737.073 440.958, 738 439.499, 738 438.973 C 738 438.447, 738.900 437.455, 740 436.768 C 741.100 436.081, 742 435.202, 742 434.815 C 742 434.428, 743.596 432.399, 745.547 430.306 C 747.498 428.213, 749.845 425.262, 750.762 423.750 C 751.680 422.238, 752.784 421, 753.216 421 C 753.647 421, 754 420.555, 754 420.011 C 754 419.133, 755.340 417.236, 758.500 413.638 C 763.537 407.905, 768 400.883, 768 398.693 C 768 395.695, 764.961 393.560, 762.022 394.493 C 760.976 394.825, 757.956 397.644, 755.310 400.757 C 752.665 403.871, 749.487 407.388, 748.250 408.574 C 747.013 409.759, 746 411.010, 746 411.353 C 746 412.197, 743.005 415.827, 740.250 418.323 C 739.013 419.444, 738 420.790, 738 421.316 C 738 421.841, 736.987 423.324, 735.750 424.611 C 734.513 425.898, 732.825 427.772, 732 428.775 C 731.175 429.778, 727.575 434.170, 724 438.535 C 715.352 449.095, 714.861 449.673, 712.250 452.389 C 711.013 453.676, 710 455.215, 710 455.808 C 710 456.401, 709.212 457.476, 708.250 458.197 C 707.288 458.917, 704.942 461.530, 703.037 464.003 C 701.132 466.476, 699.220 468.650, 698.787 468.833 C 698.354 469.017, 698 469.788, 698 470.548 C 698 471.308, 697.100 472.411, 696 473 C 694.900 473.589, 694 474.448, 694 474.909 C 694 475.370, 692.200 477.716, 690 480.123 C 687.800 482.530, 686 485.046, 686 485.714 C 686 486.383, 685.100 487.411, 684 488 C 682.900 488.589, 681.998 489.617, 681.995 490.285 C 681.993 490.953, 680.755 492.850, 679.245 494.500 C 677.735 496.150, 674.925 499.669, 673 502.319 C 669.881 506.613, 665.647 511.926, 659.899 518.758 C 658.855 519.999, 657.998 521.349, 657.995 521.758 C 657.993 522.166, 656.643 523.938, 654.995 525.696 C 653.348 527.453, 652 529.282, 652 529.759 C 652 530.236, 650.650 531.919, 649 533.500 C 647.350 535.081, 646 536.949, 646 537.652 C 646 538.355, 645.100 539.411, 644 540 C 642.900 540.589, 642 541.730, 642 542.535 C 642 543.341, 641.656 544, 641.236 544 C 640.816 544, 639.360 545.800, 638 548 C 636.640 550.200, 635.184 552, 634.764 552 C 634.344 552, 634 552.659, 634 553.465 C 634 554.270, 633.100 555.411, 632 556 C 630.900 556.589, 629.999 557.617, 629.999 558.285 C 629.998 558.953, 628.198 561.525, 626 564 C 623.802 566.475, 622.002 568.912, 622.001 569.416 C 622.001 569.920, 621.344 571.045, 620.542 571.916 C 616.204 576.629, 606 589.620, 606 590.430 C 606 591.011, 603.924 593.666, 600.282 597.741 C 599.062 599.106, 597.794 601.073, 597.465 602.111 C 597.135 603.150, 596.221 604, 595.433 604 C 594.645 604, 594 604.679, 594 605.509 C 594 606.339, 592.650 608.431, 591 610.157 C 589.350 611.884, 588 613.704, 588 614.203 C 588 614.701, 586.652 616.547, 585.005 618.304 C 583.357 620.062, 582.007 621.834, 582.005 622.241 C 582.002 622.649, 580.650 624.273, 579 625.850 C 577.350 627.426, 575.998 629.118, 575.995 629.608 C 575.993 630.099, 574.755 631.871, 573.245 633.547 C 571.735 635.223, 570.050 637.315, 569.500 638.195 C 566.156 643.548, 561.468 649.684, 559.865 650.807 C 558.839 651.525, 558 652.988, 558 654.057 C 558 655.135, 557.318 656, 556.469 656 C 555.626 656, 554.645 656.788, 554.287 657.750 C 553.929 658.712, 551.918 661.843, 549.818 664.707 C 547.718 667.571, 546 670.353, 546 670.890 C 546 671.426, 545.100 672.151, 544 672.500 C 542.900 672.849, 542 673.739, 542 674.478 C 542 675.216, 540.200 678.098, 538 680.881 C 535.800 683.664, 534 686.404, 534 686.971 C 534 687.537, 533.626 688, 533.169 688 C 532.712 688, 531.702 689.237, 530.926 690.750 C 530.149 692.263, 528.723 694.228, 527.757 695.117 C 526.791 696.007, 526 697.212, 526 697.796 C 526 699.240, 517.518 708, 516.120 708 C 515.504 708, 515 708.378, 515 708.839 C 515 710.249, 510.120 712, 506.203 711.996 C 500.371 711.990, 494.489 707.886, 489.013 700 C 487.676 698.075, 485.776 695.912, 484.791 695.193 C 483.806 694.475, 483 693.483, 483 692.989 C 483 692.495, 481.988 691.014, 480.750 689.698 C 479.512 688.382, 476.925 685.340, 475 682.938 C 473.075 680.536, 469.869 676.755, 467.877 674.536 C 462.184 668.195, 454 657.757, 454 656.836 C 454 656.376, 453.325 656, 452.500 656 C 451.675 656, 451 655.580, 451 655.067 C 451 654.554, 447.574 650.167, 443.387 645.317 C 434.382 634.888, 431.525 631.490, 427.500 626.421 C 425.850 624.343, 423.601 621.712, 422.503 620.574 C 421.405 619.437, 418.978 616.480, 417.110 614.003 C 415.242 611.526, 413.089 608.825, 412.326 608 C 408.449 603.807, 407 601.490, 407 599.482 C 407 596.856, 410.573 592, 412.505 592 C 413.253 592, 414.151 591.100, 414.500 590 C 414.849 588.900, 415.764 588, 416.532 588 C 417.301 588, 418.411 587.100, 419 586 C 419.589 584.900, 420.730 584, 421.535 584 C 422.341 584, 423.003 583.663, 423.007 583.250 C 423.011 582.837, 425.771 580.250, 429.140 577.500 C 432.509 574.750, 435.768 572.050, 436.382 571.500 C 439.443 568.761, 444.993 565, 445.974 565 C 447.268 565, 453.331 569.108, 453.866 570.347 C 454.067 570.813, 455.529 572.672, 457.116 574.479 C 458.702 576.286, 460 578.267, 460 578.882 C 460 579.497, 460.675 580, 461.500 580 C 462.325 580, 463 580.381, 463 580.847 C 463 581.652, 464.140 583.156, 469.258 589.107 C 470.491 590.540, 473.075 593.655, 475 596.028 C 476.925 598.401, 479.512 601.411, 480.750 602.717 C 481.988 604.023, 483.009 605.408, 483.020 605.795 C 483.030 606.183, 485.168 608.766, 487.770 611.536 C 490.371 614.306, 494.446 619.117, 496.825 622.227 C 503.221 630.586, 503.161 630.563, 507.314 626.250 C 523.423 609.516, 531.142 601.389, 535 597.095 C 537.475 594.341, 540.063 592.068, 540.750 592.044 C 541.438 592.020, 542 591.531, 542 590.957 C 542 590.383, 544.700 587.288, 548 584.079 C 551.300 580.870, 554 577.739, 554 577.122 C 554 576.505, 554.460 576, 555.022 576 C 556.148 576, 566 565.992, 566 564.849 C 566 564.456, 566.900 563.849, 568 563.500 C 569.100 563.151, 570 562.415, 570 561.866 C 570 561.316, 575.400 555.508, 582 548.959 C 588.600 542.410, 594 536.859, 594 536.622 C 594 536.385, 600.300 529.757, 608 521.894 C 615.700 514.030, 622 507.012, 622 506.298 C 622 505.584, 622.510 505, 623.134 505 C 624.555 505, 634 495.488, 634 494.056 C 634 493.475, 634.464 493, 635.031 493 C 635.859 493, 646 483.316, 646 482.526 C 646 482.406, 650.040 478.076, 654.977 472.904 C 659.914 467.732, 663.964 463.210, 663.977 462.856 C 663.990 462.501, 662.650 460.766, 661 459 C 659.350 457.234, 658 455.161, 658 454.394 C 658 453.627, 657.605 453, 657.122 453 C 656.638 453, 654.276 450.413, 651.872 447.250 C 649.467 444.087, 647.163 441.350, 646.750 441.167 C 646.337 440.983, 646 440.221, 646 439.473 C 646 438.725, 645.212 437.525, 644.249 436.807 C 643.287 436.088, 641.268 433.851, 639.765 431.837 C 638.261 429.822, 636.448 427.572, 635.737 426.837 C 635.026 426.101, 632.269 422.800, 629.610 419.500 C 626.951 416.200, 624.151 413.140, 623.387 412.700 C 622.624 412.260, 621.997 411.360, 621.994 410.700 C 621.990 410.040, 619.852 407.182, 617.241 404.349 C 610.567 397.107, 606 391.301, 606 390.059 C 606 389.476, 605.311 389, 604.469 389 C 603.626 389, 602.642 388.212, 602.281 387.250 C 601.919 386.288, 601.087 385.050, 600.431 384.500 C 598.318 382.730, 588 370.087, 588 369.269 C 588 368.834, 586.650 367.363, 585 366 C 583.350 364.637, 582 363.153, 582 362.702 C 582 361.973, 576.388 354.275, 574.927 353 C 574.612 352.725, 574.064 351.712, 573.708 350.750 C 573.353 349.788, 572.374 349, 571.531 349 C 570.689 349, 570 348.345, 570 347.545 C 570 346.745, 568.987 344.991, 567.750 343.646 C 564.103 339.683, 558 331.266, 558 330.200 C 558 329.658, 557.349 328.964, 556.552 328.658 C 555.756 328.353, 554.357 326.657, 553.443 324.890 C 552.529 323.123, 550.706 320.517, 549.391 319.099 C 548.076 317.681, 547 316.032, 547 315.435 C 547 314.837, 545.875 313.292, 544.500 312 C 543.125 310.708, 542 309.042, 542 308.296 C 542 307.551, 540.200 304.664, 538 301.881 C 535.800 299.098, 534 296.241, 534 295.533 C 534 294.824, 533.299 293.663, 532.442 292.952 C 531.585 292.241, 530.258 290.161, 529.493 288.330 C 528.728 286.498, 527.629 285, 527.051 285 C 526.473 285, 526 284.100, 526 283 C 526 281.900, 525.663 280.996, 525.250 280.992 C 524.497 280.984, 522 276.261, 522 274.846 C 522 273.791, 517.101 269, 516.023 269 C 515.535 269, 514.279 270.238, 513.231 271.750"
                      fill="#1fbf56"
                      fillRule="evenodd"
                    />
                  </Svg>
                ) : (
                  <View style={[styles.iconContainer, { backgroundColor: `${page.color}20` }]}>
                    <Ionicons name={page.icon as any} size={60} color={page.color} />
                  </View>
                )}
                <Text style={[styles.title, { color: colors.text }]}>{page.title}</Text>
                <Text style={[styles.description, { color: colors.mutedText }]}>
                  {page.description}
                </Text>
              </View>
            )}
          </View>
        ))}
      </ScrollView>

      {/* Indicateurs de page */}
      <View style={styles.indicators}>
        {onboardingPages.map((_, index) => (
          <View
            key={index}
            style={[
              styles.indicator,
              {
                backgroundColor: currentPage === index ? colors.primary : colors.mutedText + '40',
                width: currentPage === index ? 24 : 8,
              },
            ]}
          />
        ))}
      </View>

      {/* Boutons de navigation */}
      <View style={[styles.footer, { paddingBottom: Math.max(insets.bottom, 20) }]}>
        {currentPage > 0 && (
          <TouchableOpacity
            onPress={() => {
              triggerSelection();
              const prevPage = currentPage - 1;
              setCurrentPage(prevPage);
              scrollViewRef.current?.scrollTo({ x: prevPage * SCREEN_WIDTH, animated: true });
            }}
            style={[
              styles.backButton, 
              { 
                borderColor: colors.primary,
                backgroundColor: mode === 'dark' ? colors.card : 'transparent',
              }
            ]}
          >
            <Text style={[styles.backButtonText, { color: colors.primary }]}>
              {t('onboarding.back' as any)}
            </Text>
          </TouchableOpacity>
        )}
        <TouchableOpacity
          onPress={handleNext}
          disabled={currentPage === 3 && !selectedMode}
          style={[
            styles.nextButton,
            {
              backgroundColor: currentPage === 3 && !selectedMode ? colors.mutedText + '60' : colors.primary,
              flex: currentPage === 0 ? 1 : undefined,
              opacity: currentPage === 3 && !selectedMode ? 0.6 : 1,
            },
          ]}
        >
          <Text style={styles.nextButtonText}>
            {currentPage === onboardingPages.length - 1
              ? t('onboarding.start' as any)
              : t('onboarding.next' as any)}
          </Text>
          {currentPage < onboardingPages.length - 1 && (
            <Ionicons name="arrow-forward" size={20} color="#fff" style={{ marginLeft: 8 }} />
          )}
        </TouchableOpacity>
      </View>
    </SafeAreaView>
  );
}

const styles = StyleSheet.create({
  container: {
    flex: 1,
    backgroundColor: '#fff',
  },
  header: {
    flexDirection: 'row',
    justifyContent: 'flex-end',
    paddingHorizontal: 20,
    paddingTop: 10,
    paddingBottom: 10,
  },
  skipButton: {
    paddingVertical: 8,
    paddingHorizontal: 12,
  },
  skipText: {
    fontSize: 16,
    fontWeight: '500',
  },
  page: {
    flex: 1,
    justifyContent: 'center',
    alignItems: 'center',
  },
  content: {
    flex: 1,
    justifyContent: 'center',
    alignItems: 'center',
    paddingHorizontal: 30,
    paddingTop: 20,
  },
  scrollableContent: {
    flex: 1,
    width: '100%',
  },
  scrollableContentContainer: {
    flexGrow: 1,
    justifyContent: 'center',
    alignItems: 'center',
    paddingHorizontal: 30,
    paddingTop: 20,
    paddingBottom: 20,
  },
  iconContainer: {
    width: 120,
    height: 120,
    borderRadius: 60,
    justifyContent: 'center',
    alignItems: 'center',
    marginBottom: 30,
  },
  title: {
    fontSize: 26,
    fontWeight: 'bold',
    textAlign: 'center',
    marginBottom: 16,
  },
  description: {
    fontSize: 16,
    textAlign: 'center',
    lineHeight: 24,
  },
  appIcon: {
    width: 100,
    height: 100,
    marginBottom: 30,
  },
  modesContainer: {
    width: '100%',
    paddingHorizontal: 0,
    paddingBottom: 0,
    marginTop: 10,
    alignItems: 'center',
  },
  modeCard: {
    width: SCREEN_WIDTH * 0.85,
    padding: 24,
    borderRadius: 16,
    marginBottom: 0,
    position: 'relative',
    minHeight: 140,
    shadowColor: '#000',
    shadowOffset: {
      width: 0,
      height: 2,
    },
    shadowOpacity: 0.1,
    shadowRadius: 4,
    elevation: 3,
  },
  checkIconContainer: {
    position: 'absolute',
    top: 10,
    right: 10,
  },
  modeTitle: {
    fontSize: 18,
    fontWeight: 'bold',
    marginBottom: 10,
    textAlign: 'center',
  },
  modeDescription: {
    fontSize: 14,
    textAlign: 'center',
    lineHeight: 20,
  },
  modeSpacer: {
    height: 24,
  },
  indicators: {
    flexDirection: 'row',
    justifyContent: 'center',
    alignItems: 'center',
    paddingVertical: 20,
    gap: 8,
  },
  indicator: {
    height: 8,
    borderRadius: 4,
  },
  footer: {
    flexDirection: 'row',
    justifyContent: 'space-between',
    alignItems: 'center',
    paddingHorizontal: 20,
    paddingTop: 20,
    gap: 12,
  },
  backButton: {
    paddingVertical: 14,
    paddingHorizontal: 24,
    borderRadius: 12,
    borderWidth: 2,
  },
  backButtonText: {
    fontSize: 16,
    fontWeight: '600',
  },
  nextButton: {
    flexDirection: 'row',
    alignItems: 'center',
    justifyContent: 'center',
    paddingVertical: 14,
    paddingHorizontal: 32,
    borderRadius: 12,
    minWidth: 120,
  },
  nextButtonText: {
    color: '#fff',
    fontSize: 16,
    fontWeight: 'bold',
  },
});

